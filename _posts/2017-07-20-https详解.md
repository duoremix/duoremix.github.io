---
layout: default
title: HTTPS详解
comments: true
---

# HTTPS详解

## 1、什么是tcp、ssl
网络七层协议：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层。

tcp存在于传输层，用于应用程序之间的通信。建立连接需要三次握手。

ssl介于应用层和tcp层之间。应用层数据不再直接传递给传输层，而是传递给ssl层，ssl层对从应用层收到的数据进行加密，并增加自己的ssl头。

## 2、http介绍

http通信过程：

```
1、建立tcp连接
2、浏览器向服务器发送请求命令
3、浏览器发送请求头信息
4、服务器应答
5、服务器发送应答头信息
6、服务器发送数据
7、服务器关闭tcp连接（如果头信息中存在Connection:keep-alive，tcp连接不会关闭）
```


---
layout: default
title: git操作注意事项
comments: true
---

http协议的缺点：

```
1、通信使用明文，内容容易被窃听（抓包工具、开发者工具均可获取请求和响应内容）
2、没有验证通讯方的身份，容易伪装（postman请求攻击接口）
3、无法验证报文完整性，可能会遭到篡改（中间插入任何第三方都没有办法检测出来）
```

解决办法：

```
1、对请求响应内容进行加密
2、对通讯方的身份进行验证
3、检验报文是否被篡改过
```
## 3、HTTPS实现原理

https握手过程：

```
1、浏览器发出请求
2、服务器用私钥加密网页内容，连同指定一种HASH算法、加密算法（非对称）、数字证书（含公钥、网站地址、证书颁发机构等）一起发送给浏览器
3、浏览器查看解开数字证书是否在【证书管理器】的【受信任根证书颁发机构列表】中
(ps:若证书记载网址不一致，或不是受信任机构颁发，浏览器会发出警告）
4、若证书合法，浏览器随机产生一串序列号，用公钥加密，生成返回信息
5、使用HASH算法将返回信息加密，生成消息校验值，连同消息一起返回服务器
6、服务器用私钥解开返回信息，得到随机序列号
7、使用HASH算法加密序列号，检验是否与消息校验值一致，若一致，说明消息未被篡改，可以信任
8、服务器使用随机序列号+HASH算法加密一段握手消息，带上HASH值，发送给浏览器
9、浏览器接收消息，检查HASH值是否与发挥的消息一致，若一致，说明消息未被篡改，可以信任；检查消息是否为握手消息
10、握手结束后，使用握手阶段产生的随机数和加密算法进行对称加密解密传输
```

为什么不直接全程使用非对称加密算法？


```
因为非对称算法效率比对称算法效率低，会影响通信效率，因此只在https握手阶段使用。
```


